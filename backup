#!/usr/bin/env python

from lib.database import Database
from lib.menu import Menu
from lib.inlretro import dump
from lib.inesheader import add_header
from os import path

database = Database('vendor/xml/nesdb.xml')
menu = Menu()

game = None
while(game == None):
    input = raw_input("Search for game: ")
    suggestions = database.search(input)
    selection = menu.select_item(suggestions)
    if selection != None:
        game = database.get_game_for_search_string(selection)
        
print("Creating backup for %s, %s" % (game.name, game.catalog))

# TODO: make a temp file for this
bin_path = path.abspath('test.bin')
dump(game, bin_path)

# TODO: how are we gonna get the final filename?
add_header(game, bin_path, 'smb3.nes')
